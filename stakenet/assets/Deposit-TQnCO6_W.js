import{R as a,S as e,W as t,U as s,V as i,E as n,X as l}from"./MsStake-_ET-cN_1.js";import{E as o}from"./el-input-HlLf9ju_.js";import{u,C as r,b as d}from"./custompopups-j3QrYe5F.js";/* empty css               */import{E as c}from"./ERC20--Hx32Bsk.js";import{d as v,L as p,r as m,x as f,o as w,c as g,f as S,b as x,E,u as b,t as y,n as h,e as C,F as O,a as k,g as D,p as A,h as N,_ as F}from"./index-t1OzRuHN.js";import{P as B}from"./planet-mPBntv1q.js";import{g as T}from"./index-LKU9NO6Q.js";const _=""+new URL("mini-logo-S1yfH9AD.png",import.meta.url).href,j=a=>(A("data-v-bf6cef6c"),a=a(),N(),a),V={class:"deposit"},I={class:"list"},J={class:"item-row"},M=j((()=>S("div",{class:"name"},"Your balance",-1))),R={class:"parameter wrap-text"},L={class:"item-row"},U=j((()=>S("div",{class:"name"},"stake",-1))),z={class:"parameter amont"},W={class:"item-row"},K=j((()=>S("div",{class:"name"},"To",-1))),P={style:{display:"flex","align-items":"center"}},Y=j((()=>S("text",{style:{color:"#fff","font-size":"48px","text-indent":"5px"}},"Staknet",-1))),H={class:"item-row deposit-btn"},X={class:"hint-content"},$={key:0,class:"title"},q=["src"],G=["src"],Q={key:1,class:"hint-name"},Z={key:2,class:"hint-name success"},aa=F(v({__name:"Deposit",setup(v){const A=p(),N=u(),F=m(!1),j=m(),aa=m(!1),ea=m(1),ta=m("0xF09FD56e72933f4dC6817006660E6f0d13eB4E75"),sa=m(!1);f((async()=>{await na(),await la(),sa.value=window.innerWidth<=750,window.addEventListener("resize",oa)}));const ia=void 0===window.ethereum?T("https://rpc.ankr.com/eth","0xaa36a7"):new t(window.ethereum),na=async()=>{const t=new a("0x7265b91dAEE8aeFdCAc7DCd263D2624065352308",c.abi,ia),s=await t.balanceOf(A.accounts);let i=e(s.toString());return A.SetBalance(i),i},la=async()=>{const t=new a("0x7265b91dAEE8aeFdCAc7DCd263D2624065352308",c.abi,ia),s=await t.allowance(A.accounts,"0xF09FD56e72933f4dC6817006660E6f0d13eB4E75");let i=e(s.toString());return A.SetAllowance(i),i},oa=()=>{sa.value=window.innerWidth<=750},ua=async()=>{if(da.value||F.value||!j.value)return;F.value=!0,N.Setpopupsdata(!0,1);const e=new t(window.ethereum).getSigner(),n=new a(ta.value,s.abi,e);try{const e=j.value,s=i(e.toString());if(0==A.Balance)return N.Setpopupsdata(!0,6,"Your balance is insufficient"),void(F.value=!1);if(s.gt(i(A.Balance.toString())))return N.Setpopupsdata(!0,6,"Insufficient balance"),void(F.value=!1);await la();if(s.gt(i(A.Allowance.toString())))try{N.Setpopupsdata(!0,5),await(async()=>{const e=new t(window.ethereum).getSigner(),s=new a("0x7265b91dAEE8aeFdCAc7DCd263D2624065352308",c.abi,e),i=await s.approve("0xF09FD56e72933f4dC6817006660E6f0d13eB4E75",l);return await i.wait()})(),N.Setpopupsdata(!0,1)}catch(o){return F.value=!1,void((JSON.parse(JSON.stringify(o)).code="ACTION_REJECTED")?N.Setpopupsdata(!0,3):N.Setpopupsdata(!0,4))}const u=await n.Stake(i(e.toString()));await u.wait();N.Setpopupsdata(!0,2),ra(),j.value="",F.value=!1}catch(u){(JSON.parse(JSON.stringify(u)).code="ACTION_REJECTED")?N.Setpopupsdata(!0,3):N.Setpopupsdata(!0,4),F.value=!1}},ra=async()=>{j.value="",await(async()=>{const e=new a("0xF09FD56e72933f4dC6817006660E6f0d13eB4E75",s.abi,ia);let t=0;const i=await e.rInfo(),n=i.totalStakeBalance;if(0===n)return t;const l=i.rewardPerDay;t=Number((l/n*365*100).toFixed(2)),isNaN(t)&&(t=0),A.SetApr(t)})(),await na(),await la()},da=m(!1),ca=()=>{da.value=j.value<100||!/^\d*(\.\d+)?$/.test(j.value)},va=m({img:r,text:"Confirm this transaction in your wallet"});return w((()=>{window.removeEventListener("resize",oa)})),(a,e)=>{const t=o,s=n;return k(),g(O,null,[S("div",V,[x(B),S("div",{class:"deposit-con_2",style:E(b(A).isMobile?"margin-top:150px":"")},[S("div",I,[S("div",J,[M,S("div",R,y(Number(b(A).Balance))+" STAKNET",1)]),S("div",L,[U,S("div",z,[x(t,{type:"number",class:h([{"limit-hov":da.value},"amont-inp"]),oninput:"\r\n                if(value < 0){value = 0}\r\n                if(value.indexOf('.') >= 6) {value= Number(value.slice(0,value.indexOf('.'))) +value.slice(value.indexOf('.'),value.indexOf('.')+7)}\r\n                if(value.indexOf('.') > -1 && value.indexOf('.') <= 6) { value=Number(value.slice(0,value.indexOf('.'))) + value.slice(value.indexOf('.'),value.indexOf('.')+7)} \r\n                ",placeholder:"Enter stake amount",modelValue:j.value,"onUpdate:modelValue":e[0]||(e[0]=a=>j.value=a),onInput:ca,name:"",id:""},null,8,["class","modelValue"]),S("div",{class:h(["min-amont",{"limit-color":da.value}])},"Minimum stake 100 STAKNET",2)])]),S("div",W,[K,S("div",P,[S("img",{class:"logo",src:_,style:E(b(A).isMobile?"margin-left: 10px":""),alt:""},null,4),Y])])]),S("div",H,[S("div",{class:"send mousein",onClick:ua,style:E(b(A).isMobile?"margin-top: -40px":"")},"Stake",4)])],4)]),x(s,{modelValue:aa.value,"onUpdate:modelValue":e[1]||(e[1]=a=>aa.value=a),width:"30%",onClose:ra,"show-close":1!=ea.value&&5!=ea.value,"align-center":"",class:"signdialog"},{default:C((()=>[S("div",X,[ea.value<=2||5==ea.value?(k(),g("div",$,"Sign transaction")):D("",!0),S("div",{class:h(["hint-icon",{noimg:ea.value>2&&5!=ea.value}])},[1==ea.value||5==ea.value?(k(),g("img",{key:0,class:"hint-paddimg-icon",src:b(d),alt:""},null,8,q)):D("",!0),va.value.img?(k(),g("img",{key:1,class:h(["img",{paddimg:1==ea.value||5==ea.value}]),src:va.value.img,alt:""},null,10,G)):D("",!0)],2),2!=ea.value?(k(),g("div",Q,y(va.value.text),1)):(k(),g("div",Z,y(va.value.text),1))])])),_:1},8,["modelValue","show-close"])],64)}}}),[["__scopeId","data-v-bf6cef6c"]]);export{aa as default};
