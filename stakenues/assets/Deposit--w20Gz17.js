import{K as a,L as e,W as t,M as s,N as i,E as l,O as n}from"./MsStake-_l0BMAMR.js";import{E as u}from"./el-input-lXonvPvu.js";import{g as o,_ as d}from"./index-MQgnl2Gt.js";import{u as c,C as r,b as v}from"./custompopups-SohuuRKg.js";/* empty css               */import{E as p}from"./ERC20-eMS7FcOG.js";import{d as m,L as w,r as f,x as g,o as x,c as S,f as E,t as h,u as b,b as y,n as C,E as O,e as k,F as _,a as N,g as D,p as F,h as A,_ as B}from"./index-NPrZcBDP.js";const j=a=>(F("data-v-63fed16b"),a=a(),A(),a),I={class:"deposit"},J={class:"deposit-con_2"},T={class:"list"},V=j((()=>E("div",{class:"list_name"},"Your balance",-1))),R={class:"list_text"},L=j((()=>E("div",{class:"list_stake"},"stake",-1))),U={class:"parameter amont"},M=j((()=>E("div",{class:"list_stake"},"To",-1))),W=j((()=>E("div",{style:{display:"flex","align-items":"center"}},[E("img",{class:"logo",src:d,style:{width:"50px"}})],-1))),z={class:"item-row deposit-btn"},K={class:"hint-content"},P={key:0,class:"title"},Y=["src"],$=["src"],q={key:1,class:"hint-name"},G={key:2,class:"hint-name success"},H=B(m({__name:"Deposit",setup(d){const m=w(),F=c(),A=f(!1),B=f(),j=f(!1),H=f(1),Q=f("0xF09FD56e72933f4dC6817006660E6f0d13eB4E75"),X=f(!1);g((async()=>{await aa(),await ea(),X.value=window.innerWidth<=750,window.addEventListener("resize",ta)}));const Z=void 0===window.ethereum?o("https://rpc.ankr.com/eth","0xaa36a7"):new t(window.ethereum),aa=async()=>{const t=new a("0x7265b91dAEE8aeFdCAc7DCd263D2624065352308",p.abi,Z),s=await t.balanceOf(m.accounts);let i=e(s.toString());return m.SetBalance(i),i},ea=async()=>{const t=new a("0x7265b91dAEE8aeFdCAc7DCd263D2624065352308",p.abi,Z),s=await t.allowance(m.accounts,"0xF09FD56e72933f4dC6817006660E6f0d13eB4E75");let i=e(s.toString());return m.SetAllowance(i),i},ta=()=>{X.value=window.innerWidth<=750},sa=async()=>{if(la.value||A.value||!B.value)return;A.value=!0,F.Setpopupsdata(!0,1);const e=new t(window.ethereum).getSigner(),l=new a(Q.value,s.abi,e);try{const e=B.value,s=i(e.toString());if(0==m.Balance)return F.Setpopupsdata(!0,6,"The balance is not available"),void(A.value=!1);if(s.gt(i(m.Balance.toString())))return F.Setpopupsdata(!0,6,"Insufficient balance"),void(A.value=!1);await ea();if(s.gt(i(m.Allowance.toString())))try{F.Setpopupsdata(!0,5),await(async()=>{const e=new t(window.ethereum).getSigner(),s=new a("0x7265b91dAEE8aeFdCAc7DCd263D2624065352308",p.abi,e),i=await s.approve("0xF09FD56e72933f4dC6817006660E6f0d13eB4E75",n);return await i.wait()})(),F.Setpopupsdata(!0,1)}catch(u){return A.value=!1,void((JSON.parse(JSON.stringify(u)).code="ACTION_REJECTED")?F.Setpopupsdata(!0,3):F.Setpopupsdata(!0,4))}const o=await l.Stake(i(e.toString()));await o.wait();F.Setpopupsdata(!0,2),ia(),B.value="",A.value=!1}catch(o){(JSON.parse(JSON.stringify(o)).code="ACTION_REJECTED")?F.Setpopupsdata(!0,3):F.Setpopupsdata(!0,4),A.value=!1}},ia=async()=>{B.value="",await(async()=>{const e=new a("0xF09FD56e72933f4dC6817006660E6f0d13eB4E75",s.abi,Z);let t=0;const i=await e.rInfo(),l=i.totalStakeBalance;if(0===l)return t;const n=i.rewardPerDay;t=Number((n/l*365*100).toFixed(2)),isNaN(t)&&(t=0),m.SetApr(t)})(),await aa(),await ea()},la=f(!1),na=()=>{la.value=B.value<100||!/^\d*(\.\d+)?$/.test(B.value)},ua=f({img:r,text:"Confirm this transaction in your wallet"});return x((()=>{window.removeEventListener("resize",ta)})),(a,e)=>{const t=u,s=l;return N(),S(_,null,[E("div",I,[E("div",J,[E("div",T,[V,E("div",R,h(Number(b(m).Balance))+" RUNES ",1),L,E("div",U,[y(t,{type:"tel",class:C([{"limit-hov":la.value},"amont-inp"]),oninput:"\r\n                if(value < 0){value = 0}\r\n                // if(value.indexOf('.') == -1 && value.length > 6) {value=value.slice(0,6)} if(value.indexOf('0') == 0) {value=value.slice(1)}\r\n                if(value.indexOf('.') >= 6) {value= Number(value.slice(0,value.indexOf('.'))) +value.slice(value.indexOf('.'),value.indexOf('.')+7)}\r\n                if(value.indexOf('.') > -1 && value.indexOf('.') <= 6) { value=Number(value.slice(0,value.indexOf('.'))) + value.slice(value.indexOf('.'),value.indexOf('.')+7)} \r\n                ",placeholder:"Enter stake amount",modelValue:B.value,"onUpdate:modelValue":e[0]||(e[0]=a=>B.value=a),onInput:na,name:"",id:""},null,8,["class","modelValue"]),E("div",{class:C(["list_minimum",{"limit-color":la.value}])}," Minimum stake 100 RUNEs ",2)]),M,W]),E("div",z,[E("div",{class:"list_send",onClick:sa,style:O(X.value?"margin-top: -40px":"")}," Stake ",4)])])]),y(s,{modelValue:j.value,"onUpdate:modelValue":e[1]||(e[1]=a=>j.value=a),width:"30%",onClose:ia,"show-close":1!=H.value&&5!=H.value,"align-center":"",class:"signdialog"},{default:k((()=>[E("div",K,[H.value<=2||5==H.value?(N(),S("div",P," Sign transaction ")):D("",!0),E("div",{class:C(["hint-icon",{noimg:H.value>2&&5!=H.value}])},[1==H.value||5==H.value?(N(),S("img",{key:0,class:"hint-paddimg-icon",src:b(v),alt:""},null,8,Y)):D("",!0),ua.value.img?(N(),S("img",{key:1,class:C(["img",{paddimg:1==H.value||5==H.value}]),src:ua.value.img,alt:""},null,10,$)):D("",!0)],2),2!=H.value?(N(),S("div",q,h(ua.value.text),1)):(N(),S("div",G,h(ua.value.text),1))])])),_:1},8,["modelValue","show-close"])],64)}}}),[["__scopeId","data-v-63fed16b"]]);export{H as default};
