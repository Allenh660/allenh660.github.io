import{W as e,K as a,M as t,L as s,N as l,E as n}from"./MsStake-iw_DxEVZ.js";import{E as i}from"./el-input-PVN7fMVO.js";import{_ as d}from"./MetaMask-8E0tWPSn.js";import{u as o,C as u,b as c}from"./custompopups-Esm_BiU5.js";/* empty css               */import{E as r}from"./ERC20-52pCtVWV.js";import{d as v,L as m,r as p,x as w,o as f,c as x,f as g,E as y,u as h,t as k,n as S,b as E,e as b,F as C,a as O,g as _,p as F,h as A,_ as D}from"./index-lRGnzVmH.js";const M=e=>(F("data-v-b3d6194c"),e=e(),A(),e),U={class:"deposit unstake"},j={class:"list"},N=M((()=>g("div",{class:"name"},[g("text",{class:"new__name"},"Wallet address")],-1))),V=M((()=>g("div",{style:{display:"grid","place-items":"center","padding-bottom":"15px"}},[g("img",{class:"img",src:d,style:{width:"32px"}})],-1))),z={style:{color:"#06ffdb","margin-left":"10px","font-size":"12px","text-align":"center"}},B=M((()=>g("div",{class:"name"},[g("text",{class:"new__name"},"Your staked")],-1))),L={class:"parameter wrap-text",style:{color:"#06ffdb"}},T=M((()=>g("div",{class:"name"},[g("text",{class:"new__name"},"Unstake")],-1))),W=M((()=>g("div",{class:"min-amont",style:{"font-size":"20px"}},"MPU",-1))),I={class:"hint-content"},J={key:0,class:"title"},P=["src"],R=["src"],q={key:1,class:"hint-name"},K={key:2,class:"hint-name success"},Y=D(v({__name:"Unstake",setup(d){const v=m(),F=o(),A=p(),D=p(!1),M=p(1),Y=p(!1);w((async()=>{await X(),await Z(),await G(),Y.value=window.innerWidth<=750,window.addEventListener("resize",ee)}));const $=async()=>{if(+A.value)if(+A.value>+v.StakedAmount)F.Setpopupsdata(!0,6,"Cannot exceed the staked amount");else try{F.Setpopupsdata(!0,1);let e=await Q(A.value);await e.wait();F.Setpopupsdata(!0,2),H(),G()}catch(e){(JSON.parse(JSON.stringify(e)).code="ACTION_REJECTED")?F.Setpopupsdata(!0,3):F.Setpopupsdata(!0,4)}},G=async()=>{const l=new e(window.ethereum),n=new a("0xF09FD56e72933f4dC6817006660E6f0d13eB4E75",t.abi,l),i=(await n.userTotalStakeMap(v.accounts)).userTotalStakeAmount;let d=s(i.toString());return v.SetStakedAmount(d),d},H=async()=>{A.value="",await X(),await Z(),await G()},Q=async s=>{const n=new e(window.ethereum).getSigner(),i=new a("0xF09FD56e72933f4dC6817006660E6f0d13eB4E75",t.abi,n);return await i.Unstake(l(s))},X=async()=>{const t=new e(window.ethereum),l=new a("0x7265b91dAEE8aeFdCAc7DCd263D2624065352308",r.abi,t),n=await l.balanceOf(v.accounts);let i=s(n.toString());return v.SetBalance(i),i},Z=async()=>{const t=new e(window.ethereum),l=new a("0x7265b91dAEE8aeFdCAc7DCd263D2624065352308",r.abi,t),n=await l.allowance(v.accounts,"0xF09FD56e72933f4dC6817006660E6f0d13eB4E75");let i=s(n.toString());return v.SetAllowance(i),i},ee=()=>{Y.value=window.innerWidth<=750},ae=p(!1),te=()=>{ae.value=!/^[1-9]\d*(\.\d+)?$/.test(A.value)},se=p({img:u,text:"Confirm this transaction in your wallet"});return f((()=>{window.removeEventListener("resize",ee)})),(e,a)=>{const t=i,s=n;return O(),x(C,null,[g("div",U,[g("div",{class:"deposit-con_1",style:y(Y.value?"margin-top:150px":"")},[g("div",j,[N,g("div",{class:"parameter wrap-text",style:y(h(v).isMobile?"":"display:flex")},[V,g("div",z,k(h(v).accounts),1)],4),B,g("div",L,k((l=h(v).StakedAmount,(0==parseFloat(l)?"0":parseFloat(l))||"0"))+" MPU ",1),T,g("div",{class:S(["parameter amont",{"limit-hov":ae.value}])},[E(t,{type:"tel",oninput:"\r\n                if(value < 0){value = 0}\r\n                // if(value.indexOf('.') == -1 && value.length > 6) {value=value.slice(0,6)} if(value.indexOf('0') == 0) {value=value.slice(1)}\r\n                if(value.indexOf('.') >= 6) {value= Number(value.slice(0,value.indexOf('.'))) +value.slice(value.indexOf('.'),value.indexOf('.')+7)}\r\n                if(value.indexOf('.') > -1 && value.indexOf('.') <= 6) { value=Number(value.slice(0,value.indexOf('.'))) + value.slice(value.indexOf('.'),value.indexOf('.')+7)} \r\n                ",placeholder:"please enter the unstake quantity",modelValue:A.value,"onUpdate:modelValue":a[0]||(a[0]=e=>A.value=e),onInput:te,class:"amont-inp",name:"",id:"",style:{height:"40px"}},null,8,["modelValue"]),W],2)]),g("div",{class:""},[g("div",{class:"send",onClick:$},"Unstake")])],4)]),E(s,{modelValue:D.value,"onUpdate:modelValue":a[1]||(a[1]=e=>D.value=e),width:"30%",onClose:H,"show-close":1!=M.value,"align-center":"",class:"signdialog"},{default:b((()=>[g("div",I,[M.value<=2?(O(),x("div",J,"Sign transaction")):_("",!0),g("div",{class:S(["hint-icon",{noimg:M.value>2}])},[1==M.value?(O(),x("img",{key:0,class:"hint-paddimg-icon",src:h(c),alt:""},null,8,P)):_("",!0),se.value.img?(O(),x("img",{key:1,class:S(["img",{paddimg:1==M.value}]),src:se.value.img,alt:""},null,10,R)):_("",!0)],2),2!=M.value?(O(),x("div",q,k(se.value.text),1)):(O(),x("div",K,k(se.value.text),1))])])),_:1},8,["modelValue","show-close"])],64);var l}}}),[["__scopeId","data-v-b3d6194c"]]);export{Y as default};
